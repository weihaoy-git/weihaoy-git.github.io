<!doctype html>
<html lang="en"><head><meta charset="utf-8"><meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1"><meta><title>Go Programming Tips - Yenotes</title><link rel="manifest" href="/manifest.json"><meta name="application-name" content="Yenotes"><meta name="msapplication-TileImage" content="/img/favicon.svg"><meta name="apple-mobile-web-app-capable" content="yes"><meta name="apple-mobile-web-app-title" content="Yenotes"><meta name="apple-mobile-web-app-status-bar-style" content="default"><meta name="description" content="Add 0x prefix when printing hex numbersUse %#x placeholder.  12345func TestPrintHex()  &amp;amp;#123;	var i int &amp;#x3D; 0x123456	fmt.Printf(&amp;quot;%x\n&amp;quot;, i)	fmt.Printf(&amp;quot;%#x\n&amp;quot;, i)&amp;amp;#125;  121234560x123"><meta property="og:type" content="blog"><meta property="og:title" content="Go Programming Tips"><meta property="og:url" content="http://yenotes.org/2021/12/22/Go-Programming-Tips/"><meta property="og:site_name" content="Yenotes"><meta property="og:description" content="Add 0x prefix when printing hex numbersUse %#x placeholder.  12345func TestPrintHex()  &amp;amp;#123;	var i int &amp;#x3D; 0x123456	fmt.Printf(&amp;quot;%x\n&amp;quot;, i)	fmt.Printf(&amp;quot;%#x\n&amp;quot;, i)&amp;amp;#125;  121234560x123"><meta property="og:locale" content="en_US"><meta property="og:image" content="http://yenotes.org/img/og_image.png"><meta property="article:published_time" content="2021-12-22T21:08:15.000Z"><meta property="article:modified_time" content="2021-12-22T21:09:06.795Z"><meta property="article:author" content="Weihao Ye"><meta property="article:tag" content="Go"><meta property="twitter:card" content="summary"><meta property="twitter:image" content="/img/og_image.png"><script type="application/ld+json">{"@context":"https://schema.org","@type":"BlogPosting","mainEntityOfPage":{"@type":"WebPage","@id":"http://yenotes.org/2021/12/22/Go-Programming-Tips/"},"headline":"Go Programming Tips","image":["http://yenotes.org/img/og_image.png"],"datePublished":"2021-12-22T21:08:15.000Z","dateModified":"2021-12-22T21:09:06.795Z","author":{"@type":"Person","name":"Weihao Ye"},"publisher":{"@type":"Organization","name":"Yenotes","logo":{"@type":"ImageObject","url":"http://yenotes.org/img/icon_and_name_middle.png"}},"description":"Add 0x prefix when printing hex numbersUse %#x placeholder.  12345func TestPrintHex()  &amp;#123;\tvar i int &#x3D; 0x123456\tfmt.Printf(&quot;%x\\n&quot;, i)\tfmt.Printf(&quot;%#x\\n&quot;, i)&amp;#125;  121234560x123"}</script><link rel="canonical" href="http://yenotes.org/2021/12/22/Go-Programming-Tips/"><link rel="icon" href="/img/favicon.svg"><link rel="stylesheet" href="https://use.fontawesome.com/releases/v5.15.2/css/all.css"><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/highlight.js@9.12.0/styles/atom-one-light.css"><link rel="stylesheet" href="https://fonts.googleapis.com/css2?family=Ubuntu:wght@400;600&amp;family=Source+Code+Pro"><link rel="stylesheet" href="/css/default.css"><style>body>.footer,body>.navbar,body>.section{opacity:0}</style><!--!--><!--!--><!--!--><!--!--><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/cookieconsent@3.1.1/build/cookieconsent.min.css"><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/lightgallery@1.6.8/dist/css/lightgallery.min.css"><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/justifiedGallery@3.7.0/dist/css/justifiedGallery.min.css"><!--!--><!--!--><!--!--><script src="https://cdn.jsdelivr.net/npm/pace-js@1.0.2/pace.min.js"></script><!--!--><!--!--><meta name="generator" content="Hexo 5.4.0"></head><body class="is-2-column"><nav class="navbar navbar-main"><div class="container"><div class="navbar-brand justify-content-center"><a class="navbar-item navbar-logo" href="/"><img src="/img/icon_and_name_middle.png" alt="Yenotes" height="28"></a></div><div class="navbar-menu"><div class="navbar-start"><a class="navbar-item" href="/">Home</a><a class="navbar-item" href="/archives">Archives</a><a class="navbar-item" href="/categories">Categories</a><a class="navbar-item" href="/tags">Tags</a></div><div class="navbar-end"><a class="navbar-item" target="_blank" rel="noopener" title="Download on GitHub" href="https://github.com/weihaoy-git.github.io"><i class="fab fa-github"></i></a><a class="navbar-item is-hidden-tablet catalogue" title="Catalogue" href="javascript:;"><i class="fas fa-list-ul"></i></a><a class="navbar-item search" title="Search" href="javascript:;"><i class="fas fa-search"></i></a></div></div></div></nav><section class="section"><div class="container"><div class="columns"><div class="column order-2 column-main is-8-tablet is-8-desktop is-10-widescreen"><div class="card"><article class="card-content article" role="article"><div class="article-meta is-size-7 is-uppercase level is-mobile"><div class="level-left"><span class="level-item">Posted&nbsp;<time dateTime="2021-12-22T21:08:15.000Z" title="12/22/2021, 4:08:15 PM">2021-12-22</time></span><span class="level-item">Updated&nbsp;<time dateTime="2021-12-22T21:09:06.795Z" title="12/22/2021, 4:09:06 PM">2021-12-22</time></span><span class="level-item"><a class="link-muted" href="/categories/Programming-Tips/">Programming Tips</a></span></div></div><h1 class="title is-3 is-size-4-mobile">Go Programming Tips</h1><div class="content"><h2 id="Add-0x-prefix-when-printing-hex-numbers"><a href="#Add-0x-prefix-when-printing-hex-numbers" class="headerlink" title="Add 0x prefix when printing hex numbers"></a>Add 0x prefix when printing hex numbers</h2><p>Use <code>%#x</code> placeholder. </p>
<figure class="highlight go"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">func</span> <span class="title">TestPrintHex</span><span class="params">()</span></span>  &#123;</span><br><span class="line">	<span class="keyword">var</span> i <span class="keyword">int</span> = <span class="number">0x123456</span></span><br><span class="line">	fmt.Printf(<span class="string">&quot;%x\n&quot;</span>, i)</span><br><span class="line">	fmt.Printf(<span class="string">&quot;%#x\n&quot;</span>, i)</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">123456</span><br><span class="line">0x123456</span><br></pre></td></tr></table></figure>



<h2 id="Print-the-type-of-a-variable"><a href="#Print-the-type-of-a-variable" class="headerlink" title="Print the type of a variable"></a>Print the type of a variable</h2><figure class="highlight go"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">fmt.Printf(<span class="string">&quot;%T\n&quot;</span>, i)</span><br><span class="line">fmt.Println(reflect.Typeof(i))</span><br><span class="line">fmt.Prinft(<span class="string">&quot;%s\n&quot;</span>, reflect.Typeof(i).String())</span><br></pre></td></tr></table></figure>

<span id="more"></span>

<h2 id="Get-random-numbers"><a href="#Get-random-numbers" class="headerlink" title="Get random numbers"></a>Get random numbers</h2><p><code>Intn()</code> returns the next integer in the current random sequence. <code>UnixNano()</code> returns the number of nanoseconds elapsed since January 1, 1970 UTC. And the result of <code>UnixNano()</code> does not depend on the location associated with <code>t</code>.</p>
<p>We only have to set the seed once. But before we set the seed, <code>rand</code> will use the default seed. For example, the first call of <code>Intn(100)</code> always returns 81 without setting the seed. </p>
<figure class="highlight go"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">rand.Seed(time.Now().UnixNano())</span><br><span class="line">fmt.Println(rand.Intn(<span class="number">100</span>))</span><br></pre></td></tr></table></figure>



<h2 id="Temporary-variables-in-if-else-block"><a href="#Temporary-variables-in-if-else-block" class="headerlink" title="Temporary variables in if-else block"></a>Temporary variables in if-else block</h2><p>In Go, we can define variables in if-else condition statement. The scope of these temporary variables is limited within if-else block.</p>
<figure class="highlight go"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">if</span> v, p := math.Sqrt(<span class="keyword">float64</span>(sum)), math.Sin(<span class="keyword">float64</span>(sum)); v &lt; <span class="number">10</span> &amp;&amp; p &lt; <span class="number">0.5</span> &#123;</span><br><span class="line">	fmt.Println(<span class="string">&quot;True&quot;</span>)</span><br><span class="line">&#125; <span class="keyword">else</span> &#123;</span><br><span class="line">	fmt.Println(v, p)</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>



<h2 id="switch"><a href="#switch" class="headerlink" title="switch"></a>switch</h2><p>In Go, the execution does not fall through the <code>switch</code> structure. Switch cases evaluate cases from top to bottom, stopping when a case succeeds. Also, if we want to take the same action on multiple cases, we can write <code>case content1, content2:</code>.</p>
<p>In the following example, although without any <code>break</code>, the control flow jumps out of the <code>switch</code> block after executing the first case.</p>
<figure class="highlight go"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">var</span> i <span class="keyword">int</span> = <span class="number">15640</span></span><br><span class="line"><span class="keyword">switch</span> &#123;</span><br><span class="line"><span class="keyword">case</span> i &gt; <span class="number">1</span>:</span><br><span class="line">	fmt.Println(i)</span><br><span class="line"><span class="keyword">case</span> i &gt; <span class="number">2</span>:</span><br><span class="line">	fmt.Println(i)</span><br><span class="line"><span class="keyword">case</span> i &gt; <span class="number">99999</span>:</span><br><span class="line">	fmt.Println(<span class="string">&quot;false&quot;</span>)</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">15640</span><br></pre></td></tr></table></figure>



<h2 id="Slice"><a href="#Slice" class="headerlink" title="Slice"></a>Slice</h2><p>Slices share the same underlying memory with the original array. </p>
<ul>
<li>The type of slice is <code>[]T</code>.  </li>
<li><code>len()</code> returns the number of elements a slice contains.</li>
<li><code>cap()</code> returns the number of elements in the underlying array, counting from <strong>the first element in the slice</strong>.</li>
<li><code>append(slice, e1, e2, ...)</code> overwrites the elements in the underlying array if <code>slice</code> has enough capacity to contain these elements. Otherwise, it returns a new allocated slice and keeps the underlying array intact.</li>
</ul>
<figure class="highlight go"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">func</span> <span class="title">TestSlice</span><span class="params">()</span></span> &#123;</span><br><span class="line">	<span class="keyword">var</span> arr [<span class="number">5</span>]<span class="keyword">int</span> = [<span class="number">5</span>]<span class="keyword">int</span>&#123;<span class="number">0</span>, <span class="number">1</span>, <span class="number">2</span>, <span class="number">3</span>, <span class="number">4</span>&#125;</span><br><span class="line">	slice1 := arr[<span class="number">0</span>:<span class="number">4</span>]</span><br><span class="line">	slice2 := arr[<span class="number">1</span>:<span class="number">4</span>]</span><br><span class="line">	fmt.Println(arr)</span><br><span class="line">	fmt.Println(slice1)</span><br><span class="line">	fmt.Println(slice2)</span><br><span class="line">	fmt.Printf(<span class="string">&quot;type: %s, len: %d, cap: %d\n&quot;</span>, reflect.TypeOf(arr).String(), <span class="built_in">len</span>(arr), <span class="built_in">cap</span>(arr))</span><br><span class="line">	fmt.Printf(<span class="string">&quot;type: %s, len: %d, cap: %d\n&quot;</span>, reflect.TypeOf(slice1).String(), <span class="built_in">len</span>(slice1), <span class="built_in">cap</span>(slice1))</span><br><span class="line">	fmt.Printf(<span class="string">&quot;type: %s, len: %d, cap: %d\n&quot;</span>, reflect.TypeOf(slice2).String(), <span class="built_in">len</span>(slice2), <span class="built_in">cap</span>(slice2))</span><br><span class="line">	slice1[<span class="number">0</span>] = <span class="number">9</span></span><br><span class="line">	fmt.Println(arr)</span><br><span class="line">	fmt.Println(slice1)</span><br><span class="line">	fmt.Println(slice2, <span class="string">&quot;\n&quot;</span>)</span><br><span class="line"></span><br><span class="line">	<span class="comment">// Test slice append</span></span><br><span class="line">	slice3 := <span class="built_in">append</span>(slice2, <span class="number">8</span>) <span class="comment">// change the underlying array</span></span><br><span class="line">	slice4 := <span class="built_in">append</span>(slice2, <span class="number">7</span>, <span class="number">6</span>) <span class="comment">// return a new allocated slice</span></span><br><span class="line">	fmt.Println(arr, &amp;arr[<span class="number">0</span>], <span class="built_in">cap</span>(arr))</span><br><span class="line">	fmt.Println(slice1, &amp;slice1[<span class="number">0</span>], <span class="built_in">cap</span>(slice1))</span><br><span class="line">	fmt.Println(slice2, &amp;slice2[<span class="number">0</span>], <span class="built_in">cap</span>(slice2))</span><br><span class="line">	fmt.Println(slice3, &amp;slice3[<span class="number">0</span>], <span class="built_in">cap</span>(slice3))</span><br><span class="line">	fmt.Println(slice4, &amp;slice4[<span class="number">0</span>], <span class="built_in">cap</span>(slice4))</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><span class="line">[0 1 2 3 4]</span><br><span class="line">[0 1 2 3]</span><br><span class="line">[1 2 3]</span><br><span class="line">type: [5]int, len: 5, cap: 5</span><br><span class="line">type: []int, len: 4, cap: 5</span><br><span class="line">type: []int, len: 3, cap: 4</span><br><span class="line">[9 1 2 3 4]</span><br><span class="line">[9 1 2 3]</span><br><span class="line">[1 2 3] </span><br><span class="line"></span><br><span class="line">[9 1 2 3 8] 0xc000018270 5</span><br><span class="line">[9 1 2 3] 0xc000018270 5</span><br><span class="line">[1 2 3] 0xc000018278 4</span><br><span class="line">[1 2 3 8] 0xc000018278 4</span><br><span class="line">[1 2 3 7 6] 0xc00001e080 8</span><br></pre></td></tr></table></figure>



<h2 id="Variable-Length-Array"><a href="#Variable-Length-Array" class="headerlink" title="Variable Length Array"></a>Variable Length Array</h2><p>Go only allows constants to be used as array size. To create an array whose size is defined by a variabl, we can use <code>make([]T, length)</code>. It creates an underlying array with size of <code>length</code> and returns a slice of it.</p>
<figure class="highlight go"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">const</span> conLen = <span class="number">8</span></span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">func</span> <span class="title">TestVLA</span><span class="params">(length <span class="keyword">int</span>)</span></span> &#123;</span><br><span class="line">	<span class="keyword">var</span> l <span class="keyword">int</span> = <span class="number">5</span></span><br><span class="line">	<span class="comment">// illegal</span></span><br><span class="line">	<span class="comment">//var arr0 [len]int</span></span><br><span class="line">	<span class="comment">//var arr1 [l]int</span></span><br><span class="line"></span><br><span class="line">	<span class="keyword">var</span> arr2 = <span class="built_in">make</span>([]<span class="keyword">int</span>, l)</span><br><span class="line">	<span class="keyword">var</span> arr3 = <span class="built_in">make</span>([]<span class="keyword">int</span>, length)</span><br><span class="line">	<span class="keyword">var</span> arr4 [conLen]<span class="keyword">int</span></span><br><span class="line">  <span class="comment">// do something</span></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>



<h2 id="String-comparison"><a href="#String-comparison" class="headerlink" title="String comparison"></a>String comparison</h2><p>In Go, we can compare strings by using comparison operators (<code>==</code>, <code>&lt;</code>, <code>&gt;</code>, etc) or by <code>strings.Compare(s1, s2)</code>. </p>
<h2 id="File-naming-convention"><a href="#File-naming-convention" class="headerlink" title="File naming convention"></a>File naming convention</h2><p><code>snake_case</code> is the convention across the most of the standard library and most third party libraries for Go.</p>
<h2 id="defer"><a href="#defer" class="headerlink" title="defer"></a>defer</h2><p><code>defer FunctionCall()</code> defers the execution of <code>FunctionCall()</code> until the surrounding function (the parent function call of <code>FunctionCall()</code>) returns. Multiple deferred calls are stacked, so that they will be callled in a LIFO order.</p>
<figure class="highlight go"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">func</span> <span class="title">TestDefer</span><span class="params">()</span></span>  &#123;</span><br><span class="line">	<span class="keyword">for</span> i:= <span class="number">0</span>; i &lt; <span class="number">5</span>; i++ &#123;</span><br><span class="line">		<span class="keyword">defer</span> fmt.Println(<span class="string">&quot;deferred call&quot;</span>, i)</span><br><span class="line">	&#125;</span><br><span class="line">	fmt.Println(<span class="string">&quot;ready to return&quot;</span>)</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line">ready to return</span><br><span class="line">deferred call 4</span><br><span class="line">deferred call 3</span><br><span class="line">deferred call 2</span><br><span class="line">deferred call 1</span><br><span class="line">deferred call 0</span><br></pre></td></tr></table></figure>



<h2 id="Hashmap"><a href="#Hashmap" class="headerlink" title="Hashmap"></a>Hashmap</h2><p>In Go, we can declaring a hashmap by using key word <code>map</code>. <code>map</code> declares a non-thread-safe hashmap. </p>
<ul>
<li>Create a hash map: <code>hashmap := make(map[string]int)</code>, <code>string</code> is key type and <code>int</code> is value type.</li>
<li>Insert a key-value pair: <code>hashmap[key] = value</code>.</li>
<li>Delete a key-value pair: <code>delete(hashmap, key)</code>.</li>
<li>Check whether a key exists: <code>v, ok := hashmap[key]</code>. If the key exists, <code>ok == true</code>. Otherwise, <code>v</code> equals to the zero value of the value type, <code>ok == false</code>.</li>
<li>Traverse the hashmap: <code>for k, v := range hashmap &#123;// do someting&#125;</code></li>
</ul>
<h2 id="Difference-between-make-and-new"><a href="#Difference-between-make-and-new" class="headerlink" title="Difference between make and new"></a>Difference between make and new</h2><ul>
<li><code>make</code> returns a value of <code>T</code>; <code>new</code> returns a value of <code>*T</code>.</li>
<li><code>make</code> returns an <strong>initialized</strong> value; <code>new</code> returns a <strong>zeroed</strong> value.</li>
<li><code>make</code> can only create and initialize slices, maps and channels; <code>new</code> can allocate zeroed memory for any types.</li>
</ul>
<p>Take hashmap as an example. Since we need to initialize structure of hashmap itself before using it (it means that we cannot just zero the hashmap memory), we have to create a hashmap by <code>hashmap := make(map[string]int)</code> or <code>hashmap := map[string]int&#123;&#125;</code>.</p>
<h2 id="Format-go-files-recursively"><a href="#Format-go-files-recursively" class="headerlink" title="Format go files recursively"></a>Format go files recursively</h2><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">go fmt path/...</span><br></pre></td></tr></table></figure>



<h2 id="Method"><a href="#Method" class="headerlink" title="Method"></a>Method</h2><p>In Go, methods take either a value or a pointer as the receiver when they are <strong>called</strong>. Go interprets <code>s.Print()</code> as <code>(&amp;s).Print()</code>, <code>ps.SwapPrint()</code> as <code>(*ps).SwapPrint()</code>. But this is just syntactic sugar. </p>
<p>Also, we <strong>cannot</strong> define new methods for existing types in another package (including built-in types, such as <code>int</code>, <code>map</code>). But it is fine to define a normal function that takes a non-local-package type argument. Or we can define our own alias for that type in current package <code>type Alias ExistingTypeName</code>, or define a wrapper structure containing that type <code>type NewStruct struct &#123;n ExistingTypeName&#125;</code></p>
<figure class="highlight go"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">type</span> MyStruct <span class="keyword">struct</span> &#123;</span><br><span class="line">	x <span class="keyword">int</span></span><br><span class="line">	y <span class="keyword">int</span></span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">func</span> <span class="params">(ps *MyStruct)</span> <span class="title">Print</span><span class="params">()</span></span> &#123;</span><br><span class="line">	fmt.Printf(<span class="string">&quot;(%d, %d)\n&quot;</span>, ps.x, ps.y)</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">func</span> <span class="params">(s MyStruct)</span> <span class="title">SwapPrint</span><span class="params">()</span></span> &#123;</span><br><span class="line">	fmt.Printf(<span class="string">&quot;(%d, %d)\n&quot;</span>, s.y, s.x)</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">func</span> <span class="title">TestMethod</span><span class="params">()</span></span> &#123;</span><br><span class="line">	ps := <span class="built_in">new</span>(MyStruct)</span><br><span class="line">	ps.x = <span class="number">12</span></span><br><span class="line">	ps.y = <span class="number">24</span></span><br><span class="line">	s := MyStruct&#123;<span class="number">12</span>, <span class="number">24</span>&#125;</span><br><span class="line">	ps.Print()</span><br><span class="line">	ps.SwapPrint()</span><br><span class="line">	s.Print()</span><br><span class="line">	s.SwapPrint()</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>



<h2 id="Interface"><a href="#Interface" class="headerlink" title="Interface"></a>Interface</h2><p>Any concrete types that implement <strong>all</strong> methods of a interface type satisfy implicitly that interface type. In other words, a interface type specifies a set of methods that a concrete type <strong>must possess</strong> to be considered an instance of that interface. </p>
<p>Note that <code>T</code> and <code>*T</code> are different when it comes to the relationship between interfaces and concrete types. And we cannot define methods for types under another package.</p>
<figure class="highlight go"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">type</span> IntTask <span class="keyword">int</span></span><br><span class="line"><span class="keyword">type</span> FloatTask <span class="keyword">float64</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">type</span> Runner <span class="keyword">interface</span> &#123;</span><br><span class="line">	Run()</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">func</span> <span class="params">(pit *IntTask)</span> <span class="title">Run</span><span class="params">()</span></span> &#123;</span><br><span class="line">	fmt.Printf(<span class="string">&quot;running task id = %d\n&quot;</span>, <span class="keyword">int</span>(*pit))</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">func</span> <span class="title">TestInterface</span><span class="params">()</span></span> &#123;</span><br><span class="line">	<span class="keyword">var</span> task Runner</span><br><span class="line">	<span class="keyword">var</span> pit *IntTask = <span class="built_in">new</span>(IntTask)</span><br><span class="line">	*pit = <span class="number">1</span></span><br><span class="line">	<span class="keyword">var</span> it IntTask = <span class="number">2</span></span><br><span class="line"></span><br><span class="line">	fmt.Println(<span class="keyword">int</span>(*pit))</span><br><span class="line">	fmt.Println(<span class="keyword">int</span>(it))</span><br><span class="line"></span><br><span class="line">	task = pit</span><br><span class="line">	<span class="comment">// illegal</span></span><br><span class="line">	<span class="comment">//task = id</span></span><br><span class="line">	task.Run()</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>Since only <code>*ID</code> implements <code>Run()</code> method, <code>*ID</code> satisfies interface <code>Runnable</code> but <code>ID</code> does not.</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">running task id = 1</span><br></pre></td></tr></table></figure>



<h2 id="Empty-interface"><a href="#Empty-interface" class="headerlink" title="Empty interface"></a>Empty interface</h2><p><code>interface&#123;&#125;</code> is empty interface. Because it has no methods, all types satisfy the empty interface.</p>
<h2 id="Interface-Pitfall"><a href="#Interface-Pitfall" class="headerlink" title="Interface Pitfall"></a>Interface Pitfall</h2><p>An interface value with a <code>nil</code> dynamic value is <strong>NOT</strong> the same as a <code>nil</code> interface <strong>for any non-empty interfaces</strong>.</p>
<p>If we assign <code>nil</code> to an empty interface variable, that variable is still equal to <code>nil</code>.</p>
<p>If you want to keep the interface value consistent with its concrete value, please do not define a concrete value first then assign it to the interface value, but define the interface value directly (allocate a concrete value by <code>new</code>).</p>
<figure class="highlight go"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">func</span> <span class="title">TestPitfall</span><span class="params">()</span></span> &#123;</span><br><span class="line">	<span class="keyword">var</span> pit *IntTask      <span class="comment">// zeroed as nil</span></span><br><span class="line">	<span class="keyword">var</span> run1 Runner = pit <span class="comment">// warning: run1 is not nil</span></span><br><span class="line">	<span class="keyword">var</span> run2 Runner       <span class="comment">// zeroed as nil</span></span><br><span class="line">	<span class="keyword">var</span> run3 Runner = <span class="built_in">new</span>(IntTask)</span><br><span class="line">	<span class="keyword">var</span> emptyInterface <span class="keyword">interface</span>&#123;&#125; = <span class="literal">nil</span></span><br><span class="line">	fmt.Printf(<span class="string">&quot;run1 == nil ? %t\n&quot;</span>, run1 == <span class="literal">nil</span>)</span><br><span class="line">	fmt.Printf(<span class="string">&quot;run2 == nil ? %t\n&quot;</span>, run2 == <span class="literal">nil</span>)</span><br><span class="line">	fmt.Printf(<span class="string">&quot;run3 == nil ? %t\n&quot;</span>, run3 == <span class="literal">nil</span>)</span><br><span class="line">	fmt.Printf(<span class="string">&quot;emptyInterface == nil ? %t\n&quot;</span>, emptyInterface == <span class="literal">nil</span>)</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">run1 == nil ? false</span><br><span class="line">run2 == nil ? true</span><br><span class="line">run3 == nil ? false</span><br><span class="line">emptyInterface == nil ? true</span><br></pre></td></tr></table></figure>



<h2 id="Sort"><a href="#Sort" class="headerlink" title="Sort"></a>Sort</h2><p><code>sort.Ints()</code> and <code>sort.Strings()</code> only accept slice as argument. <code>sort.Sort()</code> provide a customizable method that requires the data type to be sorted should implement <code>Len()</code>, <code>Swap()</code> and <code>Less()</code>.</p>
<figure class="highlight go"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">var</span> arr = [<span class="number">10</span>]<span class="keyword">int</span>&#123;<span class="number">2</span>, <span class="number">3</span>, <span class="number">4</span>, <span class="number">6</span>, <span class="number">7</span>, <span class="number">9</span>, <span class="number">2</span>, <span class="number">3</span>, <span class="number">4</span>, <span class="number">5</span>&#125;</span><br><span class="line">sort.Ints(arr[:])</span><br></pre></td></tr></table></figure>



<h2 id="Type-Assertion"><a href="#Type-Assertion" class="headerlink" title="Type Assertion"></a>Type Assertion</h2><p>The general form of type assertion is <code>x.(T)</code>, while <code>x</code> is an interface to be tested (asserted), <code>T</code> can be a concrete type or another interface type. There are two usages of type assertion.</p>
<ol>
<li><code>T</code> is a concrete type. The type assertion checks whether the concrete type of <code>x</code> is identical to <code>T</code>.</li>
<li><code>T</code> is an interface type. The type assertion checks whether the concrete type of <code>x</code> satisfies interface <code>T</code>.</li>
<li>A successful type assertion returns the dynamic value in type <code>T</code>, and an optional assertion flag. A failed type assertion returns <code>nil</code> and flag <code>false</code>, if the statement only accepts one return value, it will cause a panic.</li>
</ol>
<figure class="highlight go"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">func</span> <span class="title">TestTypeAssert</span><span class="params">()</span></span> &#123;</span><br><span class="line">	<span class="keyword">var</span> itRunner Runner = <span class="built_in">new</span>(IntTask)</span><br><span class="line">	<span class="keyword">var</span> ftRunner Runner = <span class="built_in">new</span>(FloatTask)</span><br><span class="line"></span><br><span class="line">	itRunner.Run()</span><br><span class="line">	ftRunner.Run()</span><br><span class="line">	<span class="comment">// if without ok flag, such as pit2 := ftRunner.(*IntTask)</span></span><br><span class="line">	<span class="comment">// false assertions will cause panic</span></span><br><span class="line">	pit, okInt := itRunner.(*IntTask)</span><br><span class="line">	pit2, okInt2 := ftRunner.(*IntTask)</span><br><span class="line">	pft, okFloat := ftRunner.(*FloatTask)</span><br><span class="line">	pft2, okFloat2 := itRunner.(*FloatTask)</span><br><span class="line">	fmt.Printf(<span class="string">&quot;assert itRunner to *IntTask: %t %T %p\n&quot;</span>, okInt, pit, pit)</span><br><span class="line">	fmt.Printf(<span class="string">&quot;assert ftRunner to *IntTask: %t %T %p\n&quot;</span>, okInt2, pit2, pit2)</span><br><span class="line">	fmt.Printf(<span class="string">&quot;assert ftRunner to *FloatTask: %t %T %p\n&quot;</span>, okFloat, pft, pft)</span><br><span class="line">	fmt.Printf(<span class="string">&quot;assert itRunner to *FloatTask: %t %T %p\n&quot;</span>, okFloat2, pft2, pft2)</span><br><span class="line">	*pit = <span class="number">15640</span></span><br><span class="line">	*pft = <span class="number">15.64</span></span><br><span class="line">	itRunner.Run()</span><br><span class="line">	ftRunner.Run()</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>



<h2 id="Type-Switch"><a href="#Type-Switch" class="headerlink" title="Type Switch"></a>Type Switch</h2><p>We can use a type switch statement to replace an if-else chain of type assertions.</p>
<figure class="highlight go"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">func</span> <span class="title">TestTypeSwitch</span><span class="params">()</span></span> &#123;</span><br><span class="line">	<span class="keyword">var</span> i <span class="keyword">int</span> = <span class="number">15640</span></span><br><span class="line">	<span class="keyword">var</span> j <span class="keyword">float64</span> = <span class="number">15.64</span></span><br><span class="line">	<span class="keyword">var</span> k <span class="keyword">string</span> = <span class="string">&quot;DS&quot;</span></span><br><span class="line">	TypeSwitch1(i)</span><br><span class="line">	TypeSwitch1(j)</span><br><span class="line">	TypeSwitch1(k)</span><br><span class="line">	fmt.Println(<span class="string">&quot;&quot;</span>)</span><br><span class="line">	TypeSwitch2(i)</span><br><span class="line">	TypeSwitch2(j)</span><br><span class="line">	TypeSwitch2(k)</span><br><span class="line">	fmt.Println(<span class="string">&quot;&quot;</span>)</span><br><span class="line">	TypeSwitch3(i)</span><br><span class="line">	TypeSwitch3(j)</span><br><span class="line">	TypeSwitch3(k)</span><br><span class="line">	fmt.Println(<span class="string">&quot;&quot;</span>)</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">func</span> <span class="title">TypeSwitch1</span><span class="params">(x <span class="keyword">interface</span>&#123;&#125;)</span></span> &#123;</span><br><span class="line">	<span class="keyword">switch</span> x := x.(<span class="keyword">type</span>) &#123;</span><br><span class="line">	<span class="keyword">case</span> <span class="keyword">int</span>:</span><br><span class="line">		fmt.Printf(<span class="string">&quot;case int: value = %d, type = %T\n&quot;</span>, x, x)</span><br><span class="line">	<span class="keyword">case</span> <span class="keyword">float64</span>:</span><br><span class="line">		fmt.Printf(<span class="string">&quot;case float64: value = %f, type = %T\n&quot;</span>, x, x)</span><br><span class="line">	<span class="keyword">default</span>:</span><br><span class="line">		fmt.Printf(<span class="string">&quot;Unexpected Type\n&quot;</span>)</span><br><span class="line">	&#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">func</span> <span class="title">TypeSwitch2</span><span class="params">(x <span class="keyword">interface</span>&#123;&#125;)</span></span> &#123;</span><br><span class="line">	<span class="keyword">switch</span> x.(<span class="keyword">type</span>) &#123;</span><br><span class="line">	<span class="keyword">case</span> <span class="keyword">int</span>:</span><br><span class="line">		fmt.Printf(<span class="string">&quot;case int: value = %d, type = %T\n&quot;</span>, x, x)</span><br><span class="line">	<span class="keyword">case</span> <span class="keyword">float64</span>:</span><br><span class="line">		fmt.Printf(<span class="string">&quot;case float64: value = %f, type = %T\n&quot;</span>, x, x)</span><br><span class="line">	<span class="keyword">default</span>:</span><br><span class="line">		fmt.Printf(<span class="string">&quot;Unexpected Type\n&quot;</span>)</span><br><span class="line">	&#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">func</span> <span class="title">TypeSwitch3</span><span class="params">(x <span class="keyword">interface</span>&#123;&#125;)</span></span> &#123;</span><br><span class="line">	<span class="keyword">switch</span> x := x.(<span class="keyword">type</span>) &#123;</span><br><span class="line">	<span class="keyword">case</span> <span class="keyword">int</span>, <span class="keyword">float64</span>:</span><br><span class="line">		fmt.Printf(<span class="string">&quot;Valid Type: %T\n&quot;</span>, x)</span><br><span class="line">	<span class="keyword">default</span>:</span><br><span class="line">		fmt.Printf(<span class="string">&quot;Unexpected Type\n&quot;</span>)</span><br><span class="line">	&#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line">case int: value = 15640, type = int</span><br><span class="line">case float64: value = 15.640000, type = float64</span><br><span class="line">Unexpected Type</span><br><span class="line"></span><br><span class="line">case int: value = 15640, type = int</span><br><span class="line">case float64: value = 15.640000, type = float64</span><br><span class="line">Unexpected Type</span><br><span class="line"></span><br><span class="line">Valid Type: int</span><br><span class="line">Valid Type: float64</span><br><span class="line">Unexpected Type</span><br></pre></td></tr></table></figure>



<h2 id="map-channel-and-reference-in-Go"><a href="#map-channel-and-reference-in-Go" class="headerlink" title="map, channel and reference in Go"></a>map, channel and reference in Go</h2><p>First of all, there is <strong>NO</strong> strict reference (alias) in Go, which means two variables <strong>refer</strong> (not point) to the same memeory location. <strong>In Go, everything is passed by value.</strong></p>
<p>But we can see that in Go <code>map</code> and <code>channel</code> can be passed by reference in function. This is because <strong><code>map</code> and <code>channel</code> are pointers naturally</strong>, while do not look like pointers. For example, a <code>map</code> variable is actually a pointer to a <code>runtime.hmap</code> structure. </p>
<p>By the way, channels act as FIFO queues.</p>
<h2 id="Closed-and-drained-channel"><a href="#Closed-and-drained-channel" class="headerlink" title="Closed and drained channel"></a>Closed and drained channel</h2><p>Read requests (not matter how many times) to a closed and drained channel always immediately returns a zero value. But we can examine receives on a closed and drained channel by using optional flag.</p>
<figure class="highlight go"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">func</span> <span class="title">TestChannel</span><span class="params">()</span></span> &#123;</span><br><span class="line">	channel := <span class="built_in">make</span>(<span class="keyword">chan</span> <span class="keyword">int</span>, <span class="number">10</span>)</span><br><span class="line">	<span class="built_in">close</span>(channel)</span><br><span class="line">	<span class="keyword">for</span> &#123;</span><br><span class="line">		x, ok := &lt;- channel</span><br><span class="line">		<span class="keyword">if</span> !ok &#123;</span><br><span class="line">			<span class="keyword">break</span></span><br><span class="line">		&#125;</span><br><span class="line">		fmt.Println(x)</span><br><span class="line">	&#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>Or we can read elements from a channel by <code>range</code>, which will terminate the loop after reading the last element in a closed channel.</p>
<figure class="highlight go"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">func</span> <span class="title">TestChannel</span><span class="params">()</span></span> &#123;</span><br><span class="line">	channel := <span class="built_in">make</span>(<span class="keyword">chan</span> <span class="keyword">int</span>, <span class="number">10</span>)</span><br><span class="line">	channel &lt;- <span class="number">1</span></span><br><span class="line">	channel &lt;- <span class="number">2</span></span><br><span class="line">	channel &lt;- <span class="number">3</span></span><br><span class="line">	<span class="built_in">close</span>(channel)</span><br><span class="line">	<span class="keyword">for</span> x := <span class="keyword">range</span> channel &#123;</span><br><span class="line">		fmt.Println(x)</span><br><span class="line">	&#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>



<h2 id="Unidirectional-channel-types"><a href="#Unidirectional-channel-types" class="headerlink" title="Unidirectional channel types"></a>Unidirectional channel types</h2><p><code>chan&lt;- T</code>: send-only channel; <code>&lt;-chan T</code>: receive-only channel. They can be used in function arguments to restrict the opertions to channels.</p>
<p>Conversions from bidirectional channel to unidirectional channel types are permitted in any assignment. But there is no going back.</p>
<h2 id="nil-channel"><a href="#nil-channel" class="headerlink" title="nil channel"></a>nil channel</h2><p>Send and receive operations on a nil channel block forever.</p>
<h2 id="select"><a href="#select" class="headerlink" title="select"></a>select</h2><p>In <code>select</code>, each case specifies a <strong>communication</strong> (a send or receive operation on some channel) and an associated block of statements.</p>
<ul>
<li>If there is only one runnable case, execute that case.</li>
<li>If there is multiple runnable cases, randomly execute one of them.</li>
<li>If there is no runnable cases, block.</li>
</ul>
<p>The <code>default</code> case in a <code>select</code> is run if no other case is ready. We can use <code>select</code> and a closed channel to terminate goroutines politely.</p>
<h2 id="Terminate-a-goroutine"><a href="#Terminate-a-goroutine" class="headerlink" title="Terminate a goroutine"></a>Terminate a goroutine</h2><p>First, there is no way for one goroutine to terminate another directly. If we want to terminate a goroutine, we should send a “signal” to that goroutine and let it handles the signal by executing <code>return</code>. This signal can be implemented by a <strong>closed and drained channel</strong>. Because each receive operations to a closed and drained channel always immediately returns a zero value.</p>
<p>It sounds great, right? But the problem is that if a goroutine is blocked, it cannot notice the signal at the same time. Thus, we need to ensure two things:</p>
<ol>
<li>If this routine may be blocked by other methods (<code>listener.Accept()</code>, etc), unblock these methods in <code>Close()</code>, for example, by <code>listener.Close()</code>.</li>
<li>If this routine may be blocked by channel operations, always wrap every channel operation with a select-done structure. In other words, every channel operation should have a done case <strong>in parallel</strong>.</li>
</ol>
<figure class="highlight go"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">var</span> done = <span class="built_in">make</span>(<span class="keyword">chan</span> <span class="keyword">bool</span>)        <span class="comment">// always empty</span></span><br><span class="line"><span class="keyword">var</span> workChan = <span class="built_in">make</span>(<span class="keyword">chan</span> <span class="keyword">int</span>, <span class="number">10</span>) <span class="comment">// a buffered channel storing data</span></span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">func</span> <span class="title">Close</span><span class="params">()</span></span> &#123;</span><br><span class="line">  <span class="comment">// broadcast termination signal</span></span><br><span class="line">	<span class="built_in">close</span>(done)</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">func</span> <span class="title">sampleRoutine</span><span class="params">()</span></span> &#123;</span><br><span class="line">	<span class="comment">// ...</span></span><br><span class="line">	<span class="keyword">select</span> &#123;</span><br><span class="line">	<span class="keyword">case</span> workChan &lt;- data:</span><br><span class="line">	<span class="comment">// do some non-blocking tasks</span></span><br><span class="line">	<span class="keyword">case</span> &lt;-done:</span><br><span class="line">		<span class="keyword">return</span></span><br><span class="line">	&#125;</span><br><span class="line">	<span class="comment">// ...</span></span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">func</span> <span class="title">sampleRoutine2</span><span class="params">()</span></span> &#123;</span><br><span class="line">	<span class="comment">// ...</span></span><br><span class="line">	<span class="keyword">select</span> &#123;</span><br><span class="line">	<span class="keyword">default</span>:</span><br><span class="line">	<span class="comment">// do some non-blocking tasks</span></span><br><span class="line">	<span class="keyword">case</span> &lt;-done:</span><br><span class="line">		<span class="keyword">return</span></span><br><span class="line">	&#125;</span><br><span class="line">	<span class="comment">// ...</span></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>If we use <code>for range</code> to receive data from a channel in a goroutine function, which makes it hard to receive the termination signal, it can be rewritten by <code>for&#123;&#125;</code> and <code>select</code>. </p>
<figure class="highlight go"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">func</span> <span class="title">sampleForRange</span><span class="params">()</span></span> &#123;</span><br><span class="line">	<span class="comment">// terminate loop automatically when workChan is closed and drained</span></span><br><span class="line">  <span class="comment">// cannot receive </span></span><br><span class="line">	<span class="keyword">for</span> res := <span class="keyword">range</span> workChan &#123;</span><br><span class="line">		<span class="comment">// ...</span></span><br><span class="line">	&#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">func</span> <span class="title">sampleForSelect</span><span class="params">()</span></span> &#123;</span><br><span class="line">	<span class="keyword">for</span> &#123;</span><br><span class="line">		<span class="keyword">select</span> &#123;</span><br><span class="line">		<span class="keyword">case</span> res, ok := &lt;-workChan:</span><br><span class="line">			<span class="keyword">if</span> !ok &#123; <span class="comment">// workChan is closed and drained</span></span><br><span class="line">				<span class="keyword">return</span></span><br><span class="line">			&#125;</span><br><span class="line">			<span class="comment">// ...</span></span><br><span class="line">		<span class="keyword">case</span> &lt;-done:</span><br><span class="line">			<span class="keyword">return</span></span><br><span class="line">		&#125;</span><br><span class="line">	&#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>



<h2 id="An-ingenious-example-of-decoupling-on-channel-operation"><a href="#An-ingenious-example-of-decoupling-on-channel-operation" class="headerlink" title="An ingenious example of decoupling on channel operation"></a>An ingenious example of decoupling on channel operation</h2><figure class="highlight go"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// work routine pulls integers from input channel</span></span><br><span class="line"><span class="comment">// squares them and pushes results to output channel</span></span><br><span class="line"><span class="function"><span class="keyword">func</span> <span class="params">(sq *SquarerImpl)</span> <span class="title">work</span><span class="params">()</span></span> &#123;</span><br><span class="line">	<span class="keyword">var</span> toPush <span class="keyword">int</span></span><br><span class="line">	dummy := <span class="built_in">make</span>(<span class="keyword">chan</span> <span class="keyword">int</span>)</span><br><span class="line">	pushOn := dummy</span><br><span class="line">	pullOn := sq.input</span><br><span class="line">	<span class="keyword">for</span> &#123;</span><br><span class="line">		<span class="keyword">select</span> &#123;</span><br><span class="line">		<span class="keyword">case</span> unsquared := &lt;-pullOn:</span><br><span class="line">			toPush = unsquared * unsquared</span><br><span class="line">			pushOn = sq.output</span><br><span class="line">			pullOn = <span class="literal">nil</span></span><br><span class="line">		<span class="keyword">case</span> pushOn &lt;- toPush:</span><br><span class="line">			pushOn = dummy</span><br><span class="line">			pullOn = sq.input</span><br><span class="line">		<span class="keyword">case</span> &lt;-sq.<span class="built_in">close</span>:</span><br><span class="line">			sq.closed &lt;- <span class="literal">true</span></span><br><span class="line">			<span class="keyword">return</span></span><br><span class="line">		&#125;</span><br><span class="line">	&#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>



<h2 id="The-constant-generator-iota"><a href="#The-constant-generator-iota" class="headerlink" title="The constant generator iota"></a>The constant generator iota</h2><p>In a const declaration, the value of <code>iota</code> begins at zero and increments by one for each item in the sequence.</p>
<figure class="highlight go"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">const</span> (</span><br><span class="line">	zero  = <span class="literal">iota</span> <span class="comment">// 0</span></span><br><span class="line">	one          <span class="comment">// 1</span></span><br><span class="line">	two          <span class="comment">// 2</span></span><br><span class="line">	three        <span class="comment">// 3</span></span><br><span class="line">	four         <span class="comment">// 4</span></span><br><span class="line">)</span><br><span class="line"></span><br><span class="line"><span class="keyword">const</span> (</span><br><span class="line">	first  = <span class="number">1</span> + <span class="literal">iota</span> <span class="comment">// 1</span></span><br><span class="line">	second            <span class="comment">// 2</span></span><br><span class="line">	third             <span class="comment">// 3</span></span><br><span class="line">)</span><br><span class="line"></span><br><span class="line"><span class="keyword">const</span> (</span><br><span class="line">	_  = <span class="number">1</span> &lt;&lt; (<span class="number">10</span> * <span class="literal">iota</span>)</span><br><span class="line">	KB <span class="comment">// 1024</span></span><br><span class="line">	MB <span class="comment">// 1024 * 1024</span></span><br><span class="line">	GB <span class="comment">// 1024 * 1024 * 1024</span></span><br><span class="line">)</span><br></pre></td></tr></table></figure>



<h2 id="Asynchronous-Request-Implementation"><a href="#Asynchronous-Request-Implementation" class="headerlink" title="Asynchronous Request Implementation"></a>Asynchronous Request Implementation</h2><figure class="highlight go"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">type</span> Request <span class="keyword">struct</span> &#123;</span><br><span class="line">	reqType ReqType</span><br><span class="line">	retChan <span class="keyword">chan</span> <span class="keyword">interface</span>&#123;&#125;</span><br><span class="line">	reqBody []<span class="keyword">interface</span>&#123;&#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>



<h2 id="Remove-the-first-element-of-a-slice"><a href="#Remove-the-first-element-of-a-slice" class="headerlink" title="Remove the first element of a slice"></a>Remove the first element of a slice</h2><p>It also applies on slices with length of 1.</p>
<figure class="highlight go"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">slice = slice[<span class="number">1</span>:]</span><br></pre></td></tr></table></figure>



<h2 id="json-Marshal"><a href="#json-Marshal" class="headerlink" title="json.Marshal"></a>json.Marshal</h2><p><code>json.Marshal(v)</code> takes a memory object (argument type <code>interface&#123;&#125;</code>) and return its json encoding. In network programming, it can conveniently convert a user-defined object into json payload of the packet.</p>
<h2 id="Flexible-array-members-in-a-structure"><a href="#Flexible-array-members-in-a-structure" class="headerlink" title="Flexible array members in a structure"></a>Flexible array members in a structure</h2><p>Go allows us to define flexible array members (slices) in structures. Different from C, we can define any number of slices at any places in a structure.</p>
<figure class="highlight go"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">type</span> Struct1 <span class="keyword">struct</span> &#123;</span><br><span class="line">	i <span class="keyword">int</span></span><br><span class="line">	body []<span class="keyword">interface</span>&#123;&#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">type</span> Struct2 <span class="keyword">struct</span> &#123;</span><br><span class="line">	body []<span class="keyword">interface</span>&#123;&#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">type</span> Struct3 <span class="keyword">struct</span> &#123;</span><br><span class="line">	i <span class="keyword">int</span></span><br><span class="line">	body1 []<span class="keyword">interface</span>&#123;&#125;</span><br><span class="line">	body2 []<span class="keyword">interface</span>&#123;&#125;</span><br><span class="line">	j <span class="keyword">int</span></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>



<h2 id="Pop-from-a-slice"><a href="#Pop-from-a-slice" class="headerlink" title="Pop from a slice"></a>Pop from a slice</h2><p><code>s = s[1:]</code>. It removes the first element of <code>s</code>. Note that when using this syntax, the length of <code>s</code> can be 1 or greater but cannot be 0.</p>
<figure class="highlight go"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">func</span> <span class="title">TestSlicePop</span><span class="params">()</span></span> &#123;</span><br><span class="line">	s := <span class="built_in">make</span>([]<span class="keyword">int</span>, <span class="number">1</span>)</span><br><span class="line">	s[<span class="number">0</span>] = <span class="number">16540</span></span><br><span class="line">	s = s[<span class="number">1</span>:] <span class="comment">// remove the first element</span></span><br><span class="line">	fmt.Println(<span class="built_in">len</span>(s)) <span class="comment">// print 0</span></span><br><span class="line">  s1 := <span class="built_in">make</span>([]<span class="keyword">int</span>, <span class="number">0</span>)</span><br><span class="line">	s1 = s1[<span class="number">1</span>:] <span class="comment">// ERROR!</span></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>



<h2 id="Delete-from-a-map"><a href="#Delete-from-a-map" class="headerlink" title="Delete from a map"></a>Delete from a map</h2><p>Deleting a non-existing key from a map through <code>delete()</code> makes no effect.</p>
<figure class="highlight go"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">func</span> <span class="title">TestMapDelete</span><span class="params">()</span></span> &#123;</span><br><span class="line">	hashmap := <span class="built_in">make</span>(<span class="keyword">map</span>[<span class="keyword">int</span>]<span class="keyword">int</span>)</span><br><span class="line">	hashmap[<span class="number">1</span>] = <span class="number">1</span></span><br><span class="line">	<span class="built_in">delete</span>(hashmap, <span class="number">0</span>)</span><br><span class="line">	<span class="keyword">for</span> k, v := <span class="keyword">range</span> hashmap &#123;</span><br><span class="line">		fmt.Printf(<span class="string">&quot;[%d, %d]\n&quot;</span>, k, v)</span><br><span class="line">	&#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">[1, 1]</span><br></pre></td></tr></table></figure>



<h2 id="Constants-in-Go"><a href="#Constants-in-Go" class="headerlink" title="Constants in Go"></a>Constants in Go</h2><p>Go does <strong>NOT</strong> support constant members in structures or constant structures.</p>
<h2 id="Implement-timing-events-by-ticker"><a href="#Implement-timing-events-by-ticker" class="headerlink" title="Implement timing events by ticker"></a>Implement timing events by ticker</h2><p>We can create a ticker through <code>time.NewTicker(interval)</code>, which generates ticks in its channel <code>ticker.C</code> at specified time intervals (obviously, the size of channel <code>C</code> is one. We do not want ticks to be accumulated). We can place the handling functions of timing events and other events in a for-select block, so that timing events will not affect the execution of normal events. </p>
<p>Note that <code>Stop()</code> will stop sending ticks to the channel <code>C</code> but will not close it, to prevent a closed drained channel issue. </p>
<figure class="highlight go"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">func</span> <span class="title">TestTicker</span><span class="params">()</span></span>  &#123;</span><br><span class="line">	ticker := time.NewTicker(<span class="number">10</span> * time.Second)</span><br><span class="line">	<span class="comment">//ticker.Stop()</span></span><br><span class="line">	<span class="keyword">for</span> &#123;</span><br><span class="line">		<span class="keyword">select</span> &#123;</span><br><span class="line">		<span class="keyword">case</span> t := &lt;-ticker.C:</span><br><span class="line">			<span class="comment">// timing event</span></span><br><span class="line">			fmt.Println(t)</span><br><span class="line">		<span class="comment">// case e := &lt;-normalEventChan:</span></span><br><span class="line">		&#125;</span><br><span class="line">	&#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>



<h2 id="Implicit-type-conversions-and-implicit-numeric-conversions"><a href="#Implicit-type-conversions-and-implicit-numeric-conversions" class="headerlink" title="Implicit type conversions and implicit numeric conversions"></a>Implicit type conversions and implicit numeric conversions</h2><p>Go does not allow implicit type conversions, and does not allow implicit numeric conversions <strong>except</strong> numeric conversions across constants.</p>
<figure class="highlight go"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">func</span> <span class="title">TestType</span><span class="params">()</span></span> &#123;</span><br><span class="line">	<span class="keyword">var</span> i <span class="keyword">int</span> = <span class="number">10</span></span><br><span class="line">	<span class="keyword">var</span> j <span class="keyword">int64</span> = <span class="number">10</span></span><br><span class="line">	<span class="keyword">var</span> k <span class="keyword">int</span> = <span class="number">10</span></span><br><span class="line">	<span class="comment">// 1/10 == 0 =&gt; 0.0</span></span><br><span class="line">	<span class="keyword">var</span> p <span class="keyword">float64</span> = <span class="number">1</span> / <span class="number">10</span></span><br><span class="line">	<span class="comment">// 1.0/10 =&gt; 1.0/10.0 =&gt; 0.1</span></span><br><span class="line">	<span class="keyword">var</span> q <span class="keyword">float64</span> = <span class="number">1.0</span> / <span class="number">10</span></span><br><span class="line">	<span class="comment">// illegal</span></span><br><span class="line">	<span class="comment">// var m float64 = 1.0 / i</span></span><br><span class="line">	_ = j <span class="comment">// to keep compiler happy</span></span><br><span class="line"></span><br><span class="line">	<span class="comment">// mismatched types</span></span><br><span class="line">	<span class="comment">// j = i</span></span><br><span class="line">	<span class="comment">// mismatched types</span></span><br><span class="line">	<span class="comment">/*</span></span><br><span class="line"><span class="comment">		if i == j &#123;</span></span><br><span class="line"><span class="comment">			fmt.Println(&quot;i == j&quot;)</span></span><br><span class="line"><span class="comment">		&#125;</span></span><br><span class="line"><span class="comment">	*/</span></span><br><span class="line">	<span class="keyword">if</span> i == k &#123;</span><br><span class="line">		fmt.Println(<span class="string">&quot;i == k&quot;</span>)</span><br><span class="line">	&#125;</span><br><span class="line">	fmt.Println(p)</span><br><span class="line">	fmt.Println(q)</span><br><span class="line">	<span class="comment">// Go does not support implicit numeric conversion</span></span><br><span class="line">	<span class="comment">// p = i / k</span></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">i == k</span><br><span class="line">0</span><br><span class="line">0.1</span><br></pre></td></tr></table></figure>

</div><div class="article-licensing box"><div class="licensing-title"><p>Go Programming Tips</p><p><a href="http://yenotes.org/2021/12/22/Go-Programming-Tips/">http://yenotes.org/2021/12/22/Go-Programming-Tips/</a></p></div><div class="licensing-meta level is-mobile"><div class="level-left"><div class="level-item is-narrow"><div><h6>Author</h6><p>Weihao Ye</p></div></div><div class="level-item is-narrow"><div><h6>Posted on</h6><p>2021-12-22</p></div></div><div class="level-item is-narrow"><div><h6>Updated on</h6><p>2021-12-22</p></div></div><div class="level-item is-narrow"><div><h6>Licensed under</h6><p><a class="icons" rel="noopener" target="_blank" title="Creative Commons" href="https://creativecommons.org/"><i class="icon fab fa-creative-commons"></i></a><a class="icons" rel="noopener" target="_blank" title="Attribution" href="https://creativecommons.org/licenses/by/4.0/"><i class="icon fab fa-creative-commons-by"></i></a><a class="icons" rel="noopener" target="_blank" title="Noncommercial" href="https://creativecommons.org/licenses/by-nc/4.0/"><i class="icon fab fa-creative-commons-nc"></i></a></p></div></div></div></div></div><div class="article-tags is-size-7 mb-4"><span class="mr-2">#</span><a class="link-muted mr-2" rel="tag" href="/tags/Go/">Go</a></div><!--!--></article></div><!--!--><nav class="post-navigation mt-4 level is-mobile"><div class="level-start"><a class="article-nav-prev level level-item link-muted" href="/2021/12/22/Java-Programming-Tips/"><i class="level-item fas fa-chevron-left"></i><span class="level-item">Java Programming Tips</span></a></div><div class="level-end"><a class="article-nav-next level level-item link-muted" href="/2021/12/10/The-C-Programming-Language-Chapter-1/"><span class="level-item">The C Programming Language Chapter-1</span><i class="level-item fas fa-chevron-right"></i></a></div></nav><!--!--></div><!--!--><div class="column column-right is-4-tablet is-4-desktop is-4-widescreen  order-3"><div class="card widget" data-type="profile"><div class="card-content"><nav class="level"><div class="level-item has-text-centered flex-shrink-1"><div><figure class="image is-128x128 mx-auto mb-2"><img class="avatar is-rounded" src="/img/avatar_real.jpg" alt="Weihao Ye"></figure><p class="title is-size-4 is-block" style="line-height:inherit;">Weihao Ye</p><p class="is-size-6 is-flex justify-content-center"><i class="fas fa-map-marker-alt mr-1"></i><span>Pittsburgh, PA</span></p></div></div></nav><nav class="level is-mobile"><div class="level-item has-text-centered is-marginless"><div><p class="heading">Posts</p><a href="/archives"><p class="title">33</p></a></div></div><div class="level-item has-text-centered is-marginless"><div><p class="heading">Categories</p><a href="/categories"><p class="title">5</p></a></div></div><div class="level-item has-text-centered is-marginless"><div><p class="heading">Tags</p><a href="/tags"><p class="title">22</p></a></div></div></nav><div class="level"><a class="level-item button is-primary is-rounded" href="https://github.com/weihaoy-git" target="_blank" rel="noopener">Follow</a></div><div class="level is-mobile is-multiline"><a class="level-item button is-transparent is-marginless" target="_blank" rel="noopener" title="Github" href="https://github.com/weihaoy-git"><i class="fab fa-github"></i></a><a class="level-item button is-transparent is-marginless" target="_blank" rel="noopener" title="LinkedIn" href="https://www.linkedin.com/in/weihao-ye/"><i class="fab fa-linkedin"></i></a></div></div></div><div class="card widget" id="toc" data-type="toc"><div class="card-content"><div class="menu"><h3 class="menu-label">Catalogue</h3><ul class="menu-list"><li><a class="level is-mobile" href="#Add-0x-prefix-when-printing-hex-numbers"><span class="level-left"><span class="level-item">1</span><span class="level-item">Add 0x prefix when printing hex numbers</span></span></a></li><li><a class="level is-mobile" href="#Print-the-type-of-a-variable"><span class="level-left"><span class="level-item">2</span><span class="level-item">Print the type of a variable</span></span></a></li><li><a class="level is-mobile" href="#Get-random-numbers"><span class="level-left"><span class="level-item">3</span><span class="level-item">Get random numbers</span></span></a></li><li><a class="level is-mobile" href="#Temporary-variables-in-if-else-block"><span class="level-left"><span class="level-item">4</span><span class="level-item">Temporary variables in if-else block</span></span></a></li><li><a class="level is-mobile" href="#switch"><span class="level-left"><span class="level-item">5</span><span class="level-item">switch</span></span></a></li><li><a class="level is-mobile" href="#Slice"><span class="level-left"><span class="level-item">6</span><span class="level-item">Slice</span></span></a></li><li><a class="level is-mobile" href="#Variable-Length-Array"><span class="level-left"><span class="level-item">7</span><span class="level-item">Variable Length Array</span></span></a></li><li><a class="level is-mobile" href="#String-comparison"><span class="level-left"><span class="level-item">8</span><span class="level-item">String comparison</span></span></a></li><li><a class="level is-mobile" href="#File-naming-convention"><span class="level-left"><span class="level-item">9</span><span class="level-item">File naming convention</span></span></a></li><li><a class="level is-mobile" href="#defer"><span class="level-left"><span class="level-item">10</span><span class="level-item">defer</span></span></a></li><li><a class="level is-mobile" href="#Hashmap"><span class="level-left"><span class="level-item">11</span><span class="level-item">Hashmap</span></span></a></li><li><a class="level is-mobile" href="#Difference-between-make-and-new"><span class="level-left"><span class="level-item">12</span><span class="level-item">Difference between make and new</span></span></a></li><li><a class="level is-mobile" href="#Format-go-files-recursively"><span class="level-left"><span class="level-item">13</span><span class="level-item">Format go files recursively</span></span></a></li><li><a class="level is-mobile" href="#Method"><span class="level-left"><span class="level-item">14</span><span class="level-item">Method</span></span></a></li><li><a class="level is-mobile" href="#Interface"><span class="level-left"><span class="level-item">15</span><span class="level-item">Interface</span></span></a></li><li><a class="level is-mobile" href="#Empty-interface"><span class="level-left"><span class="level-item">16</span><span class="level-item">Empty interface</span></span></a></li><li><a class="level is-mobile" href="#Interface-Pitfall"><span class="level-left"><span class="level-item">17</span><span class="level-item">Interface Pitfall</span></span></a></li><li><a class="level is-mobile" href="#Sort"><span class="level-left"><span class="level-item">18</span><span class="level-item">Sort</span></span></a></li><li><a class="level is-mobile" href="#Type-Assertion"><span class="level-left"><span class="level-item">19</span><span class="level-item">Type Assertion</span></span></a></li><li><a class="level is-mobile" href="#Type-Switch"><span class="level-left"><span class="level-item">20</span><span class="level-item">Type Switch</span></span></a></li><li><a class="level is-mobile" href="#map-channel-and-reference-in-Go"><span class="level-left"><span class="level-item">21</span><span class="level-item">map, channel and reference in Go</span></span></a></li><li><a class="level is-mobile" href="#Closed-and-drained-channel"><span class="level-left"><span class="level-item">22</span><span class="level-item">Closed and drained channel</span></span></a></li><li><a class="level is-mobile" href="#Unidirectional-channel-types"><span class="level-left"><span class="level-item">23</span><span class="level-item">Unidirectional channel types</span></span></a></li><li><a class="level is-mobile" href="#nil-channel"><span class="level-left"><span class="level-item">24</span><span class="level-item">nil channel</span></span></a></li><li><a class="level is-mobile" href="#select"><span class="level-left"><span class="level-item">25</span><span class="level-item">select</span></span></a></li><li><a class="level is-mobile" href="#Terminate-a-goroutine"><span class="level-left"><span class="level-item">26</span><span class="level-item">Terminate a goroutine</span></span></a></li><li><a class="level is-mobile" href="#An-ingenious-example-of-decoupling-on-channel-operation"><span class="level-left"><span class="level-item">27</span><span class="level-item">An ingenious example of decoupling on channel operation</span></span></a></li><li><a class="level is-mobile" href="#The-constant-generator-iota"><span class="level-left"><span class="level-item">28</span><span class="level-item">The constant generator iota</span></span></a></li><li><a class="level is-mobile" href="#Asynchronous-Request-Implementation"><span class="level-left"><span class="level-item">29</span><span class="level-item">Asynchronous Request Implementation</span></span></a></li><li><a class="level is-mobile" href="#Remove-the-first-element-of-a-slice"><span class="level-left"><span class="level-item">30</span><span class="level-item">Remove the first element of a slice</span></span></a></li><li><a class="level is-mobile" href="#json-Marshal"><span class="level-left"><span class="level-item">31</span><span class="level-item">json.Marshal</span></span></a></li><li><a class="level is-mobile" href="#Flexible-array-members-in-a-structure"><span class="level-left"><span class="level-item">32</span><span class="level-item">Flexible array members in a structure</span></span></a></li><li><a class="level is-mobile" href="#Pop-from-a-slice"><span class="level-left"><span class="level-item">33</span><span class="level-item">Pop from a slice</span></span></a></li><li><a class="level is-mobile" href="#Delete-from-a-map"><span class="level-left"><span class="level-item">34</span><span class="level-item">Delete from a map</span></span></a></li><li><a class="level is-mobile" href="#Constants-in-Go"><span class="level-left"><span class="level-item">35</span><span class="level-item">Constants in Go</span></span></a></li><li><a class="level is-mobile" href="#Implement-timing-events-by-ticker"><span class="level-left"><span class="level-item">36</span><span class="level-item">Implement timing events by ticker</span></span></a></li><li><a class="level is-mobile" href="#Implicit-type-conversions-and-implicit-numeric-conversions"><span class="level-left"><span class="level-item">37</span><span class="level-item">Implicit type conversions and implicit numeric conversions</span></span></a></li></ul></div></div><style>#toc .menu-list > li > a.is-active + .menu-list { display: block; }#toc .menu-list > li > a + .menu-list { display: none; }</style><script src="/js/toc.js" defer></script></div><div class="card widget" data-type="categories"><div class="card-content"><div class="menu"><h3 class="menu-label">Categories</h3><ul class="menu-list"><li><a class="level is-mobile" href="/categories/Algorithm-Template/"><span class="level-start"><span class="level-item">Algorithm Template</span></span><span class="level-end"><span class="level-item tag">1</span></span></a></li><li><a class="level is-mobile" href="/categories/C-K-R/"><span class="level-start"><span class="level-item">C - K&amp;R</span></span><span class="level-end"><span class="level-item tag">1</span></span></a></li><li><a class="level is-mobile" href="/categories/LeetCode/"><span class="level-start"><span class="level-item">LeetCode</span></span><span class="level-end"><span class="level-item tag">28</span></span></a></li><li><a class="level is-mobile" href="/categories/Math/"><span class="level-start"><span class="level-item">Math</span></span><span class="level-end"><span class="level-item tag">1</span></span></a></li><li><a class="level is-mobile" href="/categories/Programming-Tips/"><span class="level-start"><span class="level-item">Programming Tips</span></span><span class="level-end"><span class="level-item tag">2</span></span></a></li></ul></div></div></div><div class="card widget" data-type="tags"><div class="card-content"><div class="menu"><h3 class="menu-label">Tags</h3><div class="field is-grouped is-grouped-multiline"><div class="control"><a class="tags has-addons" href="/tags/Array/"><span class="tag">Array</span><span class="tag">3</span></a></div><div class="control"><a class="tags has-addons" href="/tags/BFS/"><span class="tag">BFS</span><span class="tag">2</span></a></div><div class="control"><a class="tags has-addons" href="/tags/Binary-Search/"><span class="tag">Binary Search</span><span class="tag">1</span></a></div><div class="control"><a class="tags has-addons" href="/tags/C/"><span class="tag">C</span><span class="tag">1</span></a></div><div class="control"><a class="tags has-addons" href="/tags/Coloring/"><span class="tag">Coloring</span><span class="tag">1</span></a></div><div class="control"><a class="tags has-addons" href="/tags/Common-Substring/"><span class="tag">Common Substring</span><span class="tag">2</span></a></div><div class="control"><a class="tags has-addons" href="/tags/DP/"><span class="tag">DP</span><span class="tag">7</span></a></div><div class="control"><a class="tags has-addons" href="/tags/Delta/"><span class="tag">Delta</span><span class="tag">1</span></a></div><div class="control"><a class="tags has-addons" href="/tags/Go/"><span class="tag">Go</span><span class="tag">1</span></a></div><div class="control"><a class="tags has-addons" href="/tags/Graph/"><span class="tag">Graph</span><span class="tag">1</span></a></div><div class="control"><a class="tags has-addons" href="/tags/Heap/"><span class="tag">Heap</span><span class="tag">2</span></a></div><div class="control"><a class="tags has-addons" href="/tags/Interval/"><span class="tag">Interval</span><span class="tag">8</span></a></div><div class="control"><a class="tags has-addons" href="/tags/Java/"><span class="tag">Java</span><span class="tag">2</span></a></div><div class="control"><a class="tags has-addons" href="/tags/Monotonic/"><span class="tag">Monotonic</span><span class="tag">3</span></a></div><div class="control"><a class="tags has-addons" href="/tags/Prefix-Sum/"><span class="tag">Prefix Sum</span><span class="tag">1</span></a></div><div class="control"><a class="tags has-addons" href="/tags/Queue/"><span class="tag">Queue</span><span class="tag">1</span></a></div><div class="control"><a class="tags has-addons" href="/tags/Rolling-Hash/"><span class="tag">Rolling Hash</span><span class="tag">1</span></a></div><div class="control"><a class="tags has-addons" href="/tags/Sliding-Window/"><span class="tag">Sliding Window</span><span class="tag">3</span></a></div><div class="control"><a class="tags has-addons" href="/tags/Stack/"><span class="tag">Stack</span><span class="tag">1</span></a></div><div class="control"><a class="tags has-addons" href="/tags/String/"><span class="tag">String</span><span class="tag">6</span></a></div><div class="control"><a class="tags has-addons" href="/tags/Substring/"><span class="tag">Substring</span><span class="tag">3</span></a></div><div class="control"><a class="tags has-addons" href="/tags/Tree/"><span class="tag">Tree</span><span class="tag">1</span></a></div></div></div></div></div><div class="card widget" data-type="recent-posts"><div class="card-content"><h3 class="menu-label">Recents</h3><article class="media"><div class="media-content"><p class="date"><time dateTime="2022-01-25T19:23:10.000Z">2022-01-25</time></p><p class="title"><a href="/2022/01/25/LeetCode-785-Is-Graph-Bipartite/">LeetCode 785. Is Graph Bipartite?</a></p><p class="categories"><a href="/categories/LeetCode/">LeetCode</a></p></div></article><article class="media"><div class="media-content"><p class="date"><time dateTime="2022-01-25T18:59:32.000Z">2022-01-25</time></p><p class="title"><a href="/2022/01/25/LeetCode-102-Binary-Tree-Level-Order-Traversal/">LeetCode 102. Binary Tree Level Order Traversal</a></p><p class="categories"><a href="/categories/LeetCode/">LeetCode</a></p></div></article><article class="media"><div class="media-content"><p class="date"><time dateTime="2022-01-25T17:11:06.000Z">2022-01-25</time></p><p class="title"><a href="/2022/01/25/LeetCode-57-Insert-Interval/">LeetCode 57. Insert Interval</a></p><p class="categories"><a href="/categories/LeetCode/">LeetCode</a></p></div></article><article class="media"><div class="media-content"><p class="date"><time dateTime="2022-01-25T17:03:21.000Z">2022-01-25</time></p><p class="title"><a href="/2022/01/25/LeetCode-759-Employee-Free-Time/">LeetCode 759. Employee Free Time</a></p><p class="categories"><a href="/categories/LeetCode/">LeetCode</a></p></div></article><article class="media"><div class="media-content"><p class="date"><time dateTime="2022-01-25T16:30:54.000Z">2022-01-25</time></p><p class="title"><a href="/2022/01/25/LeetCode-616-Add-Bold-Tag-in-String/">LeetCode 616. Add Bold Tag in String</a></p><p class="categories"><a href="/categories/LeetCode/">LeetCode</a></p></div></article></div></div><div class="card widget" data-type="archives"><div class="card-content"><div class="menu"><h3 class="menu-label">Archives</h3><ul class="menu-list"><li><a class="level is-mobile" href="/archives/2022/01/"><span class="level-start"><span class="level-item">January 2022</span></span><span class="level-end"><span class="level-item tag">24</span></span></a></li><li><a class="level is-mobile" href="/archives/2021/12/"><span class="level-start"><span class="level-item">December 2021</span></span><span class="level-end"><span class="level-item tag">9</span></span></a></li></ul></div></div></div></div></div></div></section><footer class="footer"><div class="container"><div class="level"><div class="level-start"><a class="footer-logo is-block mb-2" href="/"><img src="/img/icon_and_name_middle.png" alt="Yenotes" height="28"></a><p class="is-size-7"><span>&copy; 2022 Weihao Ye</span>  Powered by <a href="https://hexo.io/" target="_blank" rel="noopener">Hexo</a> &amp; <a href="https://github.com/ppoffice/hexo-theme-icarus" target="_blank" rel="noopener">Icarus</a></p></div><div class="level-end"></div></div></div></footer><script src="https://cdn.jsdelivr.net/npm/jquery@3.3.1/dist/jquery.min.js"></script><script src="https://cdn.jsdelivr.net/npm/moment@2.22.2/min/moment-with-locales.min.js"></script><script src="https://cdn.jsdelivr.net/npm/clipboard@2.0.4/dist/clipboard.min.js" defer></script><script>moment.locale("en");</script><script>var IcarusThemeSettings = {
            article: {
                highlight: {
                    clipboard: true,
                    fold: 'unfolded'
                }
            }
        };</script><script src="/js/column.js"></script><script src="/js/animation.js"></script><a id="back-to-top" title="Back to top" href="javascript:;"><i class="fas fa-chevron-up"></i></a><script src="/js/back_to_top.js" defer></script><!--!--><!--!--><!--!--><script src="https://cdn.jsdelivr.net/npm/cookieconsent@3.1.1/build/cookieconsent.min.js" defer></script><script>window.addEventListener("load", () => {
      window.cookieconsent.initialise({
        type: "info",
        theme: "edgeless",
        static: false,
        position: "bottom-left",
        content: {
          message: "This website uses cookies to improve your experience.",
          dismiss: "Got it!",
          allow: "Allow cookies",
          deny: "Decline",
          link: "Learn more",
          policy: "Cookie Policy",
          href: "https://www.cookiesandyou.com/",
        },
        palette: {
          popup: {
            background: "#edeff5",
            text: "#838391"
          },
          button: {
            background: "#4b81e8"
          },
        },
      });
    });</script><script src="https://cdn.jsdelivr.net/npm/lightgallery@1.6.8/dist/js/lightgallery.min.js" defer></script><script src="https://cdn.jsdelivr.net/npm/justifiedGallery@3.7.0/dist/js/jquery.justifiedGallery.min.js" defer></script><script>window.addEventListener("load", () => {
            if (typeof $.fn.lightGallery === 'function') {
                $('.article').lightGallery({ selector: '.gallery-item' });
            }
            if (typeof $.fn.justifiedGallery === 'function') {
                if ($('.justified-gallery > p > .gallery-item').length) {
                    $('.justified-gallery > p > .gallery-item').unwrap();
                }
                $('.justified-gallery').justifiedGallery();
            }
        });</script><!--!--><!--!--><script type="text/x-mathjax-config">MathJax.Hub.Config({
            'HTML-CSS': {
                matchFontHeight: false
            },
            SVG: {
                matchFontHeight: false
            },
            CommonHTML: {
                matchFontHeight: false
            },
            tex2jax: {
                inlineMath: [
                    ['$','$'],
                    ['\\(','\\)']
                ]
            }
        });</script><script src="https://cdn.jsdelivr.net/npm/mathjax@2.7.5/unpacked/MathJax.js?config=TeX-MML-AM_CHTML" defer></script><!--!--><!--!--><!--!--><script src="/js/main.js" defer></script><div class="searchbox"><div class="searchbox-container"><div class="searchbox-header"><div class="searchbox-input-container"><input class="searchbox-input" type="text" placeholder="Type something..."></div><a class="searchbox-close" href="javascript:;">×</a></div><div class="searchbox-body"></div></div></div><script src="/js/insight.js" defer></script><script>document.addEventListener('DOMContentLoaded', function () {
            loadInsight({"contentUrl":"/content.json"}, {"hint":"Type something...","untitled":"(Untitled)","posts":"Posts","pages":"Pages","categories":"Categories","tags":"Tags"});
        });</script></body></html>